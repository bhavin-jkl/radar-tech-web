<html lang="en">
  <head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="radar.js"></script>
    <link rel="stylesheet" href="radar.css" />
  </head>
  <body>
    <div id="root"></div>
    <div style="display: flex">
      <svg id="radar"></svg>
      
      <div style="background-color: antiquewhite">
        <div id="input-container"></div>
        <button onclick="addEntry()">Add Entry</button>
        <button classNa onclick="reset()">Reset</button>
      </div>
    </div>

    <script>
      var entries = [];

      // Load entries from local storage on page load
      window.onload = function () {
        var storedEntries = localStorage.getItem("radarEntries");
        if (storedEntries) {
          entries = JSON.parse(storedEntries);
        }
        renderEntries();
        renderRadar();
      };

      function addEntry() {
        var quadrant = parseInt(
          prompt("Enter the quadrant index (0-3) for the entry:")
        );
        var ring = parseInt(
          prompt("Enter the ring index (0-3) for the entry:")
        );
        var label = prompt("Enter the label for the entry:");
        var active = confirm("Is the entry active?");
        var moved = parseInt(
          prompt("Enter the moved value (0 or 1) for the entry:")
        );

        entries.push({ quadrant, ring, label, active, moved });
        saveEntriesToLocalStorage();
        renderEntries();
        renderRadar();
      }
      function reset() {
        localStorage.removeItem("radarEntries");
        entries = []; // Clear the entries array
        renderEntries();
        renderRadar();
      }
      function renderEntries() {
        var container = document.getElementById("input-container");
        container.innerHTML = "";

        entries.forEach(function (entry, index) {
          var entryDiv = document.createElement("div");
          entryDiv.innerHTML =
            '<input type="text" value="' +
            entry.label +
            '" onchange="updateEntry(' +
            index +
            ', this.value)">';

          container.appendChild(entryDiv);
        });
      }

      function updateEntry(index, value) {
        console.log("ss");
        entries[index].label = value;
        saveEntriesToLocalStorage();
        renderRadar();
      }

      function renderRadar() {
        var radarContainer = document.getElementById("radar");
        radarContainer.innerHTML = ""; // Clear previous graph
        radar_visualization({
          svg_id: "radar",
          width: 1450,
          height: 1000,
          colors: {
            background: "#fff",
            grid: "#dddde0",
            inactive: "#ddd",
          },
          title: "Zalando Tech Radar",
          date: "2023.02",
          quadrants: [
            { name: "Languages" },
            { name: "Infrastructure" },
            { name: "Datastores" },
            { name: "Data Management" },
          ],
          rings: [
            { name: "ADOPT", color: "#5ba300" },
            { name: "TRIAL", color: "#009eb0" },
            { name: "ASSESS", color: "#c7ba00" },
            { name: "HOLD", color: "#e09b96" },
          ],
          print_layout: true,
          links_in_new_tabs: true,
          entries: entries,
        });
      }

      function saveEntriesToLocalStorage() {
        localStorage.setItem("radarEntries", JSON.stringify(entries));
      }

      // Call the renderRadar function initially
      renderRadar();
    </script>
  </body>
</html>
