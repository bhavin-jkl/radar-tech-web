<html lang="en">
  <head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="radar.js"></script>
    <link rel="stylesheet" href="radar.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://getbootstrap.com/docs/5.3/assets/css/docs.css"
      rel="stylesheet"
    />
    <title>Bootstrap Example</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">
              Add New Tech
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="myForm">
              <div class="form-group">
                <label for="quadrant">Quadrant</label>
                <input
                  type="number"
                  class="form-control"
                  id="quadrant"
                  placeholder="Enter quadrant"
                  required
                  min="0"
                  max="3"
                />
              </div>
              <div class="form-group">
                <label for="text">Ring</label>
                <input
                  type="number"
                  class="form-control"
                  id="ring"
                  placeholder="Enter ring"
                  required
                  min="0"
                  max="3"
                />
              </div>
              <div class="form-group">
                <label for="text">Label</label>
                <input
                  type="text"
                  class="form-control"
                  id="label"
                  placeholder="Enter label"
                  required
                />
              </div>
              <div class="form-group">
                <label for="text">Active</label>
                <input
                  type="text"
                  class="form-control"
                  id="active"
                  placeholder="Enter active"
                  required
                />
              </div>
              <div class="form-group mb-3">
                <label for="message">Moved</label>
                <input
                  type="number"
                  class="form-control"
                  id="moved"
                  placeholder="Enter moved"
                  required
                  min="0"
                  max="1"
                />
              </div>
              <button type="submit" class="btn btn-primary">Add</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Radar Tech</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <button
            class="btn btn-primary"
            data-bs-toggle="modal"
            data-bs-target="#exampleModal"
            type="submit"
          >
            Add
          </button>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="row"></div>
      <div class="row">
        <div class="col background-color: blue"><svg id="radar"></svg></div>
      </div>
    </div>

    <script>

      var entries = [];
      window.onload = function () {
        var storedEntries = localStorage.getItem("radarEntries");
        if (storedEntries) {
          entries = JSON.parse(storedEntries);
        } else {
          // Set default data
          var defaultEntry = {
            quadrant: 0,
            ring: 0,
            label: "Java",
            active: true,
            moved: 1,
          };
          entries.push(defaultEntry);
          saveEntriesToLocalStorage();
        }
        renderRadar();
      };
      document
        .getElementById("myForm")
        .addEventListener("submit", function (e) {
          e.preventDefault(); // Prevent form submission

          // Get form values
          var quadrant = document.getElementById("quadrant").value;

          var ring = document.getElementById("ring").value;
          var label = document.getElementById("label").value;
          var active = document.getElementById("active").value;
          var moved = document.getElementById("moved").value;

          // Create an array to store the data
          console.log(
            "quadrant, ring, label, active, moved",
            quadrant,
            ring,
            label,
            active,
            moved
          );
          active = active === "true";
          entries.push({
            quadrant: parseInt(quadrant),
            ring: parseInt(ring),
            label: label,
            active: active,
            moved: parseInt(moved),
          });
          saveEntriesToLocalStorage();
          renderRadar();
          // Reset the form
          document.getElementById("myForm").reset();
          // Close the modal dialog
          var modal = document.getElementById("exampleModal");
          var bootstrapModal = bootstrap.Modal.getInstance(modal);
          bootstrapModal.hide();
        });

      function reset() {
        localStorage.removeItem("radarEntries");
        entries = []; // Clear the entries array
        renderRadar();
      }

      function updateEntry(index, value) {
        console.log("ss");
        entries[index].label = value;
        saveEntriesToLocalStorage();
        renderRadar();
      }

      function renderRadar() {
        var radarContainer = document.getElementById("radar");
        radarContainer.innerHTML = ""; // Clear previous graph
        radar_visualization({
          svg_id: "radar",
          width: 1450,
          height: 1000,
          colors: {
            background: "#fff",
            grid: "#dddde0",
            inactive: "#ddd",
          },
          title: "Zalando Tech Radar",
          date: "2023.02",
          quadrants: [
            { name: "Languages" },
            { name: "Infrastructure" },
            { name: "Datastores" },
            { name: "Data Management" },
          ],
          rings: [
            { name: "ADOPT", color: "#5ba300" },
            { name: "TRIAL", color: "#009eb0" },
            { name: "ASSESS", color: "#c7ba00" },
            { name: "HOLD", color: "#e09b96" },
          ],
          print_layout: true,
          links_in_new_tabs: true,
          entries: entries,
        });
      }

      function saveEntriesToLocalStorage() {
        localStorage.setItem("radarEntries", JSON.stringify(entries));
      }

      renderRadar();
    </script>
  </body>
</html>
